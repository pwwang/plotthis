<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Heatmap — Heatmap • plotthis</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Heatmap — Heatmap"><meta name="description" content="Heatmap is a popular way to visualize data in matrix format. It is widely used in biology to visualize gene expression data in microarray and RNA-seq data. The heatmap is a matrix where rows represent the samples and columns represent the features. The color of each cell represents the value of the feature in the sample. The color can be continuous or discrete. The heatmap can be split by the columns or rows to show the subgroups in the data. The heatmap can also be annotated by the columns or rows to show the additional information of the samples or features."><meta property="og:description" content="Heatmap is a popular way to visualize data in matrix format. It is widely used in biology to visualize gene expression data in microarray and RNA-seq data. The heatmap is a matrix where rows represent the samples and columns represent the features. The color of each cell represents the value of the feature in the sample. The color can be continuous or discrete. The heatmap can be split by the columns or rows to show the subgroups in the data. The heatmap can also be annotated by the columns or rows to show the additional information of the samples or features."><meta property="og:image" content="https://pwwang.github.io/plotthis/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">plotthis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/all-palettes.html">All available palettes</a></li>
    <li><a class="dropdown-item" href="../articles/basic-design.html">Basic Design Of The Plots</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pwwang/plotthis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Heatmap</h1>
      <small class="dont-index">Source: <a href="https://github.com/pwwang/plotthis/blob/master/R/heatmap.R" class="external-link"><code>R/heatmap.R</code></a></small>
      <div class="d-none name"><code>Heatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Heatmap is a popular way to visualize data in matrix format. It is widely used in biology to visualize gene expression data in microarray and RNA-seq data. The heatmap is a matrix where rows represent the samples and columns represent the features. The color of each cell represents the value of the feature in the sample. The color can be continuous or discrete. The heatmap can be split by the columns or rows to show the subgroups in the data. The heatmap can also be annotated by the columns or rows to show the additional information of the samples or features.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Heatmap</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  values_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  values_fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  in_form <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"matrix"</span>, <span class="st">"wide-columns"</span>, <span class="st">"wide-rows"</span>, <span class="st">"long"</span><span class="op">)</span>,</span>
<span>  split_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  split_by_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>  rows_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rows_by_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>  rows_split_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rows_split_by_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>  columns_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  columns_by_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>  columns_split_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  columns_split_by_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>  rows_data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  columns_data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  columns_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  columns_split_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rows_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rows_split_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  palette <span class="op">=</span> <span class="st">"RdBu"</span>,</span>
<span>  palcolor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rows_palette <span class="op">=</span> <span class="st">"Paired"</span>,</span>
<span>  rows_palcolor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rows_split_palette <span class="op">=</span> <span class="st">"simspec"</span>,</span>
<span>  rows_split_palcolor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  columns_palette <span class="op">=</span> <span class="st">"Paired"</span>,</span>
<span>  columns_palcolor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  columns_split_palette <span class="op">=</span> <span class="st">"simspec"</span>,</span>
<span>  columns_split_palcolor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pie_size_name <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>  pie_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pie_values <span class="op">=</span> <span class="st">"length"</span>,</span>
<span>  pie_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pie_group_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pie_group_by_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>  pie_palette <span class="op">=</span> <span class="st">"Spectral"</span>,</span>
<span>  pie_palcolor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bars_sample <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  label <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  label_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  violin_fill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  boxplot_fill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dot_size <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  dot_size_name <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>  legend_items <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legend_discrete <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  legend.direction <span class="op">=</span> <span class="st">"vertical"</span>,</span>
<span>  lower_quantile <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  upper_quantile <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  lower_cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  upper_cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add_bg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  bg_alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  add_reticle <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  reticle_color <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>  column_name_annotation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  column_name_legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Logic.html" class="external-link">isFALSE</a></span><span class="op">(</span><span class="va">show_column_names</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">legend.position</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  row_name_annotation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  row_name_legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Logic.html" class="external-link">isFALSE</a></span><span class="op">(</span><span class="va">show_row_names</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">legend.position</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  cluster_columns <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_row_names <span class="op">=</span> <span class="op">!</span><span class="va">row_name_annotation</span>,</span>
<span>  show_column_names <span class="op">=</span> <span class="op">!</span><span class="va">column_name_annotation</span>,</span>
<span>  border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  column_title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>  row_title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>  na_col <span class="op">=</span> <span class="st">"grey85"</span>,</span>
<span>  row_names_side <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  column_names_side <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>  column_annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  column_annotation_side <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>  column_annotation_palette <span class="op">=</span> <span class="st">"Paired"</span>,</span>
<span>  column_annotation_palcolor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  column_annotation_type <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  column_annotation_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  column_annotation_agg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_annotation_side <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>  row_annotation_palette <span class="op">=</span> <span class="st">"Paired"</span>,</span>
<span>  row_annotation_palcolor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_annotation_type <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  row_annotation_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  row_annotation_agg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  flip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">8525</span>,</span>
<span>  layer_fun_callback <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cell_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tile"</span>, <span class="st">"bars"</span>, <span class="st">"label"</span>, <span class="st">"dot"</span>, <span class="st">"violin"</span>, <span class="st">"boxplot"</span>, <span class="st">"pie"</span><span class="op">)</span>,</span>
<span>  cell_agg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  combine <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nrow <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ncol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  axes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  axis_titles <span class="op">=</span> <span class="va">axes</span>,</span>
<span>  guides <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  design <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame or matrix containing the data to be plotted.
Based on the <code>in_form</code>, the data can have the following formats:</p><ul><li><p><code>matrix</code>: A matrix with rows and columns directly representing the heatmap.</p></li>
<li><p><code>long</code>: A data frame in long format with columns for values, rows, and columns.</p></li>
<li><p><code>wide-rows</code>: A data frame in wide format with columns for heatmap rows and values,
and a single column for heatmap columns.</p></li>
<li><p><code>wide-columns</code>: A data frame in wide format with columns for heatmap columns and values,
and a single column for heatmap rows.</p></li>
<li><p><code>auto</code>: Automatically inferred from the data format.
When <code>data</code> is a matrix, <code>in_form</code> is set to <code>"matrix"</code>. When <code>columns_by</code> has more than one column,
<code>in_form</code> is set to <code>"wide-columns"</code>. When <code>rows_by</code> has more than one column,
<code>in_form</code> is set to <code>"wide-rows"</code>. Otherwise, it is set to <code>"long"</code>.</p></li>
</ul></dd>


<dt id="arg-values-by">values_by<a class="anchor" aria-label="anchor" href="#arg-values-by"></a></dt>
<dd><p>A character of column name in <code>data</code> that contains the values to be plotted.
This is required when <code>in_form</code> is <code>"long"</code>. For other formats, the values are pivoted into a column named by <code>values_by</code>.</p></dd>


<dt id="arg-values-fill">values_fill<a class="anchor" aria-label="anchor" href="#arg-values-fill"></a></dt>
<dd><p>A value to fill in the missing values in the heatmap.
When there is missing value in the data, the cluster_rows and cluster_columns will fail.</p></dd>


<dt id="arg-in-form">in_form<a class="anchor" aria-label="anchor" href="#arg-in-form"></a></dt>
<dd><p>The format of the data. Can be one of <code>"matrix"</code>, <code>"long"</code>, <code>"wide-rows"</code>, <code>"wide-columns"</code>, or <code>"auto"</code>.
Defaults to <code>"auto"</code>.</p></dd>


<dt id="arg-split-by">split_by<a class="anchor" aria-label="anchor" href="#arg-split-by"></a></dt>
<dd><p>A character of column name in <code>data</code> that contains the split information to split into multiple heatmaps.
This is used to create a list of heatmaps, one for each level of the split.
Defaults to <code>NULL</code>, meaning no split.</p></dd>


<dt id="arg-split-by-sep">split_by_sep<a class="anchor" aria-label="anchor" href="#arg-split-by-sep"></a></dt>
<dd><p>A character string to concat multiple columns in <code>split_by</code>.</p></dd>


<dt id="arg-rows-by">rows_by<a class="anchor" aria-label="anchor" href="#arg-rows-by"></a></dt>
<dd><p>A vector of column names in <code>data</code> that contains the row information.
This is used to create the rows of the heatmap.
When <code>in_form</code> is <code>"long"</code> or <code>"wide-columns"</code>, this is requied, and multiple columns can be specified,
which will be concatenated by <code>rows_by_sep</code> into a single column.</p></dd>


<dt id="arg-rows-by-sep">rows_by_sep<a class="anchor" aria-label="anchor" href="#arg-rows-by-sep"></a></dt>
<dd><p>A character string to concat multiple columns in <code>rows_by</code>.</p></dd>


<dt id="arg-rows-split-by">rows_split_by<a class="anchor" aria-label="anchor" href="#arg-rows-split-by"></a></dt>
<dd><p>A character of column name in <code>data</code> that contains the split information for rows.</p></dd>


<dt id="arg-rows-split-by-sep">rows_split_by_sep<a class="anchor" aria-label="anchor" href="#arg-rows-split-by-sep"></a></dt>
<dd><p>A character string to concat multiple columns in <code>rows_split_by</code>.</p></dd>


<dt id="arg-columns-by">columns_by<a class="anchor" aria-label="anchor" href="#arg-columns-by"></a></dt>
<dd><p>A vector of column names in <code>data</code> that contains the column information.
This is used to create the columns of the heatmap.
When <code>in_form</code> is <code>"long"</code> or <code>"wide-rows"</code>, this is required, and multiple columns can be specified,
which will be concatenated by <code>columns_by_sep</code> into a single column.</p></dd>


<dt id="arg-columns-by-sep">columns_by_sep<a class="anchor" aria-label="anchor" href="#arg-columns-by-sep"></a></dt>
<dd><p>A character string to concat multiple columns in <code>columns_by</code>.</p></dd>


<dt id="arg-columns-split-by">columns_split_by<a class="anchor" aria-label="anchor" href="#arg-columns-split-by"></a></dt>
<dd><p>A character of column name in <code>data</code> that contains the split information for columns.</p></dd>


<dt id="arg-columns-split-by-sep">columns_split_by_sep<a class="anchor" aria-label="anchor" href="#arg-columns-split-by-sep"></a></dt>
<dd><p>A character string to concat multiple columns in <code>columns_split_by</code>.</p></dd>


<dt id="arg-rows-data">rows_data<a class="anchor" aria-label="anchor" href="#arg-rows-data"></a></dt>
<dd><p>A data frame containing additional data for rows, which can be used to add annotations to the heatmap.
It will be joined to the main data by <code>rows_by</code> and <code>split_by</code> if <code>split_by</code> exists in <code>rows_data</code>.
This is useful for adding additional information to the rows of the heatmap.</p></dd>


<dt id="arg-columns-data">columns_data<a class="anchor" aria-label="anchor" href="#arg-columns-data"></a></dt>
<dd><p>A data frame containing additional data for columns, which can be used to add annotations to the heatmap.
It will be joined to the main data by <code>columns_by</code> and <code>split_by</code> if <code>split_by</code> exists in <code>columns_data</code>.
This is useful for adding additional information to the columns of the heatmap.</p></dd>


<dt id="arg-columns-name">columns_name<a class="anchor" aria-label="anchor" href="#arg-columns-name"></a></dt>
<dd><p>A character string to rename the column created by <code>columns_by</code>, which will be reflected in the name of the annotation or legend.</p></dd>


<dt id="arg-columns-split-name">columns_split_name<a class="anchor" aria-label="anchor" href="#arg-columns-split-name"></a></dt>
<dd><p>A character string to rename the column created by <code>columns_split_by</code>, which will be reflected in the name of the annotation or legend.</p></dd>


<dt id="arg-rows-name">rows_name<a class="anchor" aria-label="anchor" href="#arg-rows-name"></a></dt>
<dd><p>A character string to rename the column created by <code>rows_by</code>, which will be reflected in the name of the annotation or legend.</p></dd>


<dt id="arg-rows-split-name">rows_split_name<a class="anchor" aria-label="anchor" href="#arg-rows-split-name"></a></dt>
<dd><p>A character string to rename the column created by <code>rows_split_by</code>, which will be reflected in the name of the annotation or legend.</p></dd>


<dt id="arg-palette">palette<a class="anchor" aria-label="anchor" href="#arg-palette"></a></dt>
<dd><p>A character string specifying the palette of the heatmap cells.</p></dd>


<dt id="arg-palcolor">palcolor<a class="anchor" aria-label="anchor" href="#arg-palcolor"></a></dt>
<dd><p>A character vector of colors to override the palette of the heatmap cells.</p></dd>


<dt id="arg-rows-palette">rows_palette<a class="anchor" aria-label="anchor" href="#arg-rows-palette"></a></dt>
<dd><p>A character string specifying the palette of the row group annotation.
The default is "Paired".</p></dd>


<dt id="arg-rows-palcolor">rows_palcolor<a class="anchor" aria-label="anchor" href="#arg-rows-palcolor"></a></dt>
<dd><p>A character vector of colors to override the palette of the row group annotation.</p></dd>


<dt id="arg-rows-split-palette">rows_split_palette<a class="anchor" aria-label="anchor" href="#arg-rows-split-palette"></a></dt>
<dd><p>A character string specifying the palette of the row split annotation.
The default is "simspec".</p></dd>


<dt id="arg-rows-split-palcolor">rows_split_palcolor<a class="anchor" aria-label="anchor" href="#arg-rows-split-palcolor"></a></dt>
<dd><p>A character vector of colors to override the palette of the row split annotation.</p></dd>


<dt id="arg-columns-palette">columns_palette<a class="anchor" aria-label="anchor" href="#arg-columns-palette"></a></dt>
<dd><p>A character string specifying the palette of the column group annotation.
The default is "Paired".</p></dd>


<dt id="arg-columns-palcolor">columns_palcolor<a class="anchor" aria-label="anchor" href="#arg-columns-palcolor"></a></dt>
<dd><p>A character vector of colors to override the palette of the column group annotation.</p></dd>


<dt id="arg-columns-split-palette">columns_split_palette<a class="anchor" aria-label="anchor" href="#arg-columns-split-palette"></a></dt>
<dd><p>A character string specifying the palette of the column split annotation.
The default is "simspec".</p></dd>


<dt id="arg-columns-split-palcolor">columns_split_palcolor<a class="anchor" aria-label="anchor" href="#arg-columns-split-palcolor"></a></dt>
<dd><p>A character vector of colors to override the palette of the column split annotation.</p></dd>


<dt id="arg-pie-size-name">pie_size_name<a class="anchor" aria-label="anchor" href="#arg-pie-size-name"></a></dt>
<dd><p>A character string specifying the name of the legend for the pie size.</p></dd>


<dt id="arg-pie-size">pie_size<a class="anchor" aria-label="anchor" href="#arg-pie-size"></a></dt>
<dd><p>A numeric value or a function specifying the size of the pie chart.
If it is a function, the function should take <code>count</code> as the argument and return the size.</p></dd>


<dt id="arg-pie-values">pie_values<a class="anchor" aria-label="anchor" href="#arg-pie-values"></a></dt>
<dd><p>A function or character that can be converted to a function by <code><a href="https://rdrr.io/r/base/match.arg.html" class="external-link">match.arg()</a></code>
to calculate the values for the pie chart. Default is "length".
The function should take a vector of values as the argument and return a single value, for each
group in <code>pie_group_by</code>.</p></dd>


<dt id="arg-pie-name">pie_name<a class="anchor" aria-label="anchor" href="#arg-pie-name"></a></dt>
<dd><p>A character string to rename the column created by <code>pie_group_by</code>, which will be reflected in the name of the annotation or legend.</p></dd>


<dt id="arg-pie-group-by">pie_group_by<a class="anchor" aria-label="anchor" href="#arg-pie-group-by"></a></dt>
<dd><p>A character of column name in <code>data</code> that contains the group information for pie charts.
This is used to create pie charts in the heatmap when <code>cell_type</code> is <code>"pie"</code>.</p></dd>


<dt id="arg-pie-group-by-sep">pie_group_by_sep<a class="anchor" aria-label="anchor" href="#arg-pie-group-by-sep"></a></dt>
<dd><p>A character string to concat multiple columns in <code>pie_group_by</code>.</p></dd>


<dt id="arg-pie-palette">pie_palette<a class="anchor" aria-label="anchor" href="#arg-pie-palette"></a></dt>
<dd><p>A character string specifying the palette of the pie chart.</p></dd>


<dt id="arg-pie-palcolor">pie_palcolor<a class="anchor" aria-label="anchor" href="#arg-pie-palcolor"></a></dt>
<dd><p>A character vector of colors to override the palette of the pie chart.</p></dd>


<dt id="arg-bars-sample">bars_sample<a class="anchor" aria-label="anchor" href="#arg-bars-sample"></a></dt>
<dd><p>An integer specifying the number of samples to draw the bars.</p></dd>


<dt id="arg-label">label<a class="anchor" aria-label="anchor" href="#arg-label"></a></dt>
<dd><p>A function to calculate the labels for the heatmap cells.
It takes the aggregated values as the argument and returns the labels to be shown in the heatmap.
No labels will be shown for the NA the returned values.</p></dd>


<dt id="arg-label-size">label_size<a class="anchor" aria-label="anchor" href="#arg-label-size"></a></dt>
<dd><p>A numeric value specifying the size of the labels when <code>cell_type = "label"</code>.</p></dd>


<dt id="arg-violin-fill">violin_fill<a class="anchor" aria-label="anchor" href="#arg-violin-fill"></a></dt>
<dd><p>A character vector of colors to override the fill color of the violin plot.
If NULL, the fill color will be the same as the annotion.</p></dd>


<dt id="arg-boxplot-fill">boxplot_fill<a class="anchor" aria-label="anchor" href="#arg-boxplot-fill"></a></dt>
<dd><p>A character vector of colors to override the fill color of the boxplot.
If NULL, the fill color will be the same as the annotion.</p></dd>


<dt id="arg-dot-size">dot_size<a class="anchor" aria-label="anchor" href="#arg-dot-size"></a></dt>
<dd><p>A numeric value specifying the size of the dot or a function to calculate the size
from the values in the cell.</p></dd>


<dt id="arg-dot-size-name">dot_size_name<a class="anchor" aria-label="anchor" href="#arg-dot-size-name"></a></dt>
<dd><p>A character string specifying the name of the legend for the dot size.</p></dd>


<dt id="arg-legend-items">legend_items<a class="anchor" aria-label="anchor" href="#arg-legend-items"></a></dt>
<dd><p>A numeric vector with names to specifiy the items in the main legend.
The names will be working as the labels of the legend items.</p></dd>


<dt id="arg-legend-discrete">legend_discrete<a class="anchor" aria-label="anchor" href="#arg-legend-discrete"></a></dt>
<dd><p>A logical value indicating whether the main legend is discrete.</p></dd>


<dt id="arg-legend-position">legend.position<a class="anchor" aria-label="anchor" href="#arg-legend-position"></a></dt>
<dd><p>A character string specifying the position of the legend.
if <code>waiver()</code>, for single groups, the legend will be "none", otherwise "right".</p></dd>


<dt id="arg-legend-direction">legend.direction<a class="anchor" aria-label="anchor" href="#arg-legend-direction"></a></dt>
<dd><p>A character string specifying the direction of the legend.</p></dd>


<dt id="arg-lower-quantile-upper-quantile-lower-cutoff-upper-cutoff">lower_quantile, upper_quantile, lower_cutoff, upper_cutoff<a class="anchor" aria-label="anchor" href="#arg-lower-quantile-upper-quantile-lower-cutoff-upper-cutoff"></a></dt>
<dd><p>Vector of minimum and maximum cutoff values or quantile values for each feature.
It's applied to aggregated values when aggregated values are used (e.g. plot_type tile, label, etc).
It's applied to raw values when raw values are used (e.g. plot_type bars, etc).</p></dd>


<dt id="arg-add-bg">add_bg<a class="anchor" aria-label="anchor" href="#arg-add-bg"></a></dt>
<dd><p>A logical value indicating whether to add a background to the heatmap.
Does not work with <code>cell_type = "bars"</code> or <code>cell_type = "tile"</code>.</p></dd>


<dt id="arg-bg-alpha">bg_alpha<a class="anchor" aria-label="anchor" href="#arg-bg-alpha"></a></dt>
<dd><p>A numeric value between 0 and 1 specifying the transparency of the background.</p></dd>


<dt id="arg-add-reticle">add_reticle<a class="anchor" aria-label="anchor" href="#arg-add-reticle"></a></dt>
<dd><p>A logical value indicating whether to add a reticle to the heatmap.</p></dd>


<dt id="arg-reticle-color">reticle_color<a class="anchor" aria-label="anchor" href="#arg-reticle-color"></a></dt>
<dd><p>A character string specifying the color of the reticle.</p></dd>


<dt id="arg-column-name-annotation">column_name_annotation<a class="anchor" aria-label="anchor" href="#arg-column-name-annotation"></a></dt>
<dd><p>A logical value indicating whether to add the column annotation for the column names.
which is a simple annotaion indicating the column names.</p></dd>


<dt id="arg-column-name-legend">column_name_legend<a class="anchor" aria-label="anchor" href="#arg-column-name-legend"></a></dt>
<dd><p>A logical value indicating whether to show the legend of the column name annotation.</p></dd>


<dt id="arg-row-name-annotation">row_name_annotation<a class="anchor" aria-label="anchor" href="#arg-row-name-annotation"></a></dt>
<dd><p>A logical value indicating whether to add the row annotation for the row names.
which is a simple annotaion indicating the row names.</p></dd>


<dt id="arg-row-name-legend">row_name_legend<a class="anchor" aria-label="anchor" href="#arg-row-name-legend"></a></dt>
<dd><p>A logical value indicating whether to show the legend of the row name annotation.</p></dd>


<dt id="arg-cluster-columns">cluster_columns<a class="anchor" aria-label="anchor" href="#arg-cluster-columns"></a></dt>
<dd><p>A logical value indicating whether to cluster the columns.
If TRUE and columns_split_by is provided, the clustering will only be applied to the columns within the same split.</p></dd>


<dt id="arg-cluster-rows">cluster_rows<a class="anchor" aria-label="anchor" href="#arg-cluster-rows"></a></dt>
<dd><p>A logical value indicating whether to cluster the rows.
If TRUE and rows_split_by is provided, the clustering will only be applied to the rows within the same split.</p></dd>


<dt id="arg-show-row-names">show_row_names<a class="anchor" aria-label="anchor" href="#arg-show-row-names"></a></dt>
<dd><p>A logical value indicating whether to show the row names.
If TRUE, the legend of the row group annotation will be hidden.</p></dd>


<dt id="arg-show-column-names">show_column_names<a class="anchor" aria-label="anchor" href="#arg-show-column-names"></a></dt>
<dd><p>A logical value indicating whether to show the column names.
If TRUE, the legend of the column group annotation will be hidden.</p></dd>


<dt id="arg-border">border<a class="anchor" aria-label="anchor" href="#arg-border"></a></dt>
<dd><p>A logical value indicating whether to draw the border of the heatmap.
If TRUE, the borders of the slices will be also drawn.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>The global (column) title of the heatmap</p></dd>


<dt id="arg-column-title">column_title<a class="anchor" aria-label="anchor" href="#arg-column-title"></a></dt>
<dd><p>A character string/vector of the column name(s) to use as the title of the column group annotation.</p></dd>


<dt id="arg-row-title">row_title<a class="anchor" aria-label="anchor" href="#arg-row-title"></a></dt>
<dd><p>A character string/vector of the column name(s) to use as the title of the row group annotation.</p></dd>


<dt id="arg-na-col">na_col<a class="anchor" aria-label="anchor" href="#arg-na-col"></a></dt>
<dd><p>A character string specifying the color for missing values.
The default is "grey85".</p></dd>


<dt id="arg-row-names-side">row_names_side<a class="anchor" aria-label="anchor" href="#arg-row-names-side"></a></dt>
<dd><p>A character string specifying the side of the row names.
The default is "right".</p></dd>


<dt id="arg-column-names-side">column_names_side<a class="anchor" aria-label="anchor" href="#arg-column-names-side"></a></dt>
<dd><p>A character string specifying the side of the column names.
The default is "bottom".</p></dd>


<dt id="arg-column-annotation">column_annotation<a class="anchor" aria-label="anchor" href="#arg-column-annotation"></a></dt>
<dd><p>A character string/vector of the column name(s) to use as the column annotation.
Or a list with the keys as the names of the annotation and the values as the column names.</p></dd>


<dt id="arg-column-annotation-side">column_annotation_side<a class="anchor" aria-label="anchor" href="#arg-column-annotation-side"></a></dt>
<dd><p>A character string specifying the side of the column annotation.
Could be a list with the keys as the names of the annotation and the values as the sides.</p></dd>


<dt id="arg-column-annotation-palette">column_annotation_palette<a class="anchor" aria-label="anchor" href="#arg-column-annotation-palette"></a></dt>
<dd><p>A character string specifying the palette of the column annotation.
The default is "Paired".
Could be a list with the keys as the names of the annotation and the values as the palettes.</p></dd>


<dt id="arg-column-annotation-palcolor">column_annotation_palcolor<a class="anchor" aria-label="anchor" href="#arg-column-annotation-palcolor"></a></dt>
<dd><p>A character vector of colors to override the palette of the column annotation.
Could be a list with the keys as the names of the annotation and the values as the palcolors.</p></dd>


<dt id="arg-column-annotation-type">column_annotation_type<a class="anchor" aria-label="anchor" href="#arg-column-annotation-type"></a></dt>
<dd><p>A character string specifying the type of the column annotation.
The default is "auto". Other options are "simple", "pie", "ring", "bar", "violin", "boxplot", "density".
Could be a list with the keys as the names of the annotation and the values as the types.
If the type is "auto", the type will be determined by the type and number of the column data.</p></dd>


<dt id="arg-column-annotation-params">column_annotation_params<a class="anchor" aria-label="anchor" href="#arg-column-annotation-params"></a></dt>
<dd><p>A list of parameters passed to the annotation function.
Could be a list with the keys as the names of the annotation and the values as the parameters.</p></dd>


<dt id="arg-column-annotation-agg">column_annotation_agg<a class="anchor" aria-label="anchor" href="#arg-column-annotation-agg"></a></dt>
<dd><p>A function to aggregate the values in the column annotation.</p></dd>


<dt id="arg-row-annotation">row_annotation<a class="anchor" aria-label="anchor" href="#arg-row-annotation"></a></dt>
<dd><p>A character string/vector of the column name(s) to use as the row annotation.
Or a list with the keys as the names of the annotation and the values as the column names.</p></dd>


<dt id="arg-row-annotation-side">row_annotation_side<a class="anchor" aria-label="anchor" href="#arg-row-annotation-side"></a></dt>
<dd><p>A character string specifying the side of the row annotation.
Could be a list with the keys as the names of the annotation and the values as the sides.</p></dd>


<dt id="arg-row-annotation-palette">row_annotation_palette<a class="anchor" aria-label="anchor" href="#arg-row-annotation-palette"></a></dt>
<dd><p>A character string specifying the palette of the row annotation.
The default is "Paired".
Could be a list with the keys as the names of the annotation and the values as the palettes.</p></dd>


<dt id="arg-row-annotation-palcolor">row_annotation_palcolor<a class="anchor" aria-label="anchor" href="#arg-row-annotation-palcolor"></a></dt>
<dd><p>A character vector of colors to override the palette of the row annotation.
Could be a list with the keys as the names of the annotation and the values as the palcolors.</p></dd>


<dt id="arg-row-annotation-type">row_annotation_type<a class="anchor" aria-label="anchor" href="#arg-row-annotation-type"></a></dt>
<dd><p>A character string specifying the type of the row annotation.
The default is "auto". Other options are "simple", "pie", "ring", "bar", "violin", "boxplot", "density".
Could be a list with the keys as the names of the annotation and the values as the types.
If the type is "auto", the type will be determined by the type and number of the row data.</p></dd>


<dt id="arg-row-annotation-params">row_annotation_params<a class="anchor" aria-label="anchor" href="#arg-row-annotation-params"></a></dt>
<dd><p>A list of parameters passed to the annotation function.
Could be a list with the keys as the names of the annotation and the values as the parameters.</p></dd>


<dt id="arg-row-annotation-agg">row_annotation_agg<a class="anchor" aria-label="anchor" href="#arg-row-annotation-agg"></a></dt>
<dd><p>A function to aggregate the values in the row annotation.</p></dd>


<dt id="arg-flip">flip<a class="anchor" aria-label="anchor" href="#arg-flip"></a></dt>
<dd><p>A logical value indicating whether to flip the heatmap.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>A numeric value between 0 and 1 specifying the transparency of the heatmap cells.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>The random seed to use. Default is 8525.</p></dd>


<dt id="arg-layer-fun-callback">layer_fun_callback<a class="anchor" aria-label="anchor" href="#arg-layer-fun-callback"></a></dt>
<dd><p>A function to add additional layers to the heatmap.
The function should have the following arguments: <code>j</code>, <code>i</code>, <code>x</code>, <code>y</code>, <code>w</code>, <code>h</code>, <code>fill</code>, <code>sr</code> and <code>sc</code>.
Please also refer to the <code>layer_fun</code> argument in <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap</a></code>.</p></dd>


<dt id="arg-cell-type">cell_type<a class="anchor" aria-label="anchor" href="#arg-cell-type"></a></dt>
<dd><p>A character string specifying the type of the heatmap cells.
The default is values. Other options are "bars", "label", "dot", "violin", "boxplot".
Note that for pie chart, the values under columns specified by <code>rows</code> will not be used directly. Instead, the values
will just be counted in different <code>pie_group_by</code> groups. <code>NA</code> values will not be counted.</p></dd>


<dt id="arg-cell-agg">cell_agg<a class="anchor" aria-label="anchor" href="#arg-cell-agg"></a></dt>
<dd><p>A function to aggregate the values in the cell, for the cell type "tile" and "label".
The default is <code>mean</code>.</p></dd>


<dt id="arg-combine">combine<a class="anchor" aria-label="anchor" href="#arg-combine"></a></dt>
<dd><p>Whether to combine the plots into one when facet is FALSE. Default is TRUE.</p></dd>


<dt id="arg-nrow">nrow<a class="anchor" aria-label="anchor" href="#arg-nrow"></a></dt>
<dd><p>A numeric value specifying the number of rows in the facet.</p></dd>


<dt id="arg-ncol">ncol<a class="anchor" aria-label="anchor" href="#arg-ncol"></a></dt>
<dd><p>A numeric value specifying the number of columns in the facet.</p></dd>


<dt id="arg-byrow">byrow<a class="anchor" aria-label="anchor" href="#arg-byrow"></a></dt>
<dd><p>A logical value indicating whether to fill the plots by row.</p></dd>


<dt id="arg-axes">axes<a class="anchor" aria-label="anchor" href="#arg-axes"></a></dt>
<dd><p>A string specifying how axes should be treated. Passed to <code><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">patchwork::wrap_plots()</a></code>.
Only relevant when <code>split_by</code> is used and <code>combine</code> is TRUE.
Options are:</p><ul><li><p>'keep' will retain all axes in individual plots.</p></li>
<li><p>'collect' will remove duplicated axes when placed in the same run of rows or columns of the layout.</p></li>
<li><p>'collect_x' and 'collect_y' will remove duplicated x-axes in the columns or duplicated y-axes in the rows respectively.</p></li>
</ul></dd>


<dt id="arg-axis-titles">axis_titles<a class="anchor" aria-label="anchor" href="#arg-axis-titles"></a></dt>
<dd><p>A string specifying how axis titltes should be treated. Passed to <code><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">patchwork::wrap_plots()</a></code>.
Only relevant when <code>split_by</code> is used and <code>combine</code> is TRUE.
Options are:</p><ul><li><p>'keep' will retain all axis titles in individual plots.</p></li>
<li><p>'collect' will remove duplicated titles in one direction and merge titles in the opposite direction.</p></li>
<li><p>'collect_x' and 'collect_y' control this for x-axis titles and y-axis titles respectively.</p></li>
</ul></dd>


<dt id="arg-guides">guides<a class="anchor" aria-label="anchor" href="#arg-guides"></a></dt>
<dd><p>A string specifying how guides should be treated in the layout. Passed to <code><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">patchwork::wrap_plots()</a></code>.
Only relevant when <code>split_by</code> is used and <code>combine</code> is TRUE.
Options are:</p><ul><li><p>'collect' will collect guides below to the given nesting level, removing duplicates.</p></li>
<li><p>'keep' will stop collection at this level and let guides be placed alongside their plot.</p></li>
<li><p>'auto' will allow guides to be collected if a upper level tries, but place them alongside the plot if not.</p></li>
</ul></dd>


<dt id="arg-design">design<a class="anchor" aria-label="anchor" href="#arg-design"></a></dt>
<dd><p>Specification of the location of areas in the layout, passed to <code><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">patchwork::wrap_plots()</a></code>.
Only relevant when <code>split_by</code> is used and <code>combine</code> is TRUE. When specified, <code>nrow</code>, <code>ncol</code>, and <code>byrow</code> are ignored.
See <code><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">patchwork::wrap_plots()</a></code> for more details.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>
When <code>row_names_max_width</code> is passed, a unit is expected. But you can also pass a numeric values,
with a default unit "inches", or a string like "5inches" to specify the number and unit directly.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="heatmap-anno.html">anno_simple</a></code>, <code><a href="heatmap-anno.html">anno_points</a></code>, <code><a href="heatmap-anno.html">anno_lines</a></code>, <code><a href="heatmap-anno.html">anno_pie</a></code>, <code><a href="heatmap-anno.html">anno_violin</a></code>, <code><a href="heatmap-anno.html">anno_boxplot</a></code>, <code><a href="heatmap-anno.html">anno_density</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">8525</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">matrix_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">60</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">6</span>, ncol <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">matrix_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">matrix_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cluster"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">matrix_data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="Heatmap-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cluster"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co"># use a different color palette</span></span></span>
<span class="r-in"><span>    <span class="co"># change the main legend title</span></span></span>
<span class="r-in"><span>    <span class="co"># show row names (legend will be hidden)</span></span></span>
<span class="r-in"><span>    <span class="co"># show column names</span></span></span>
<span class="r-in"><span>    <span class="co"># change the row name annotation name and side</span></span></span>
<span class="r-in"><span>    <span class="co"># change the column name annotation name</span></span></span>
<span class="r-in"><span>    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">matrix_data</span>, palette <span class="op">=</span> <span class="st">"viridis"</span>, values_by <span class="op">=</span> <span class="st">"z-score"</span>,</span></span>
<span class="r-in"><span>       show_row_names <span class="op">=</span> <span class="cn">TRUE</span>, show_column_names <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>       rows_name <span class="op">=</span> <span class="st">"Features"</span>, row_names_side <span class="op">=</span> <span class="st">"left"</span>,</span></span>
<span class="r-in"><span>       columns_name <span class="op">=</span> <span class="st">"Samples"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="Heatmap-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cluster"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co"># flip the heatmap</span></span></span>
<span class="r-in"><span>    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">matrix_data</span>, palette <span class="op">=</span> <span class="st">"viridis"</span>, values_by <span class="op">=</span> <span class="st">"z-score"</span>,</span></span>
<span class="r-in"><span>       show_row_names <span class="op">=</span> <span class="cn">TRUE</span>, show_column_names <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>       rows_name <span class="op">=</span> <span class="st">"Features"</span>, row_names_side <span class="op">=</span> <span class="st">"left"</span>,</span></span>
<span class="r-in"><span>       columns_name <span class="op">=</span> <span class="st">"Samples"</span>, flip <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="Heatmap-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cluster"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co"># add annotations to the heatmap</span></span></span>
<span class="r-in"><span>    <span class="va">rows_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>       rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span>, <span class="st">"Z"</span><span class="op">)</span>, <span class="fl">6</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">matrix_data</span>, rows_data <span class="op">=</span> <span class="va">rows_data</span>,</span></span>
<span class="r-in"><span>        row_annotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Group <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        row_annotation_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Group <span class="op">=</span> <span class="st">"simple"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        row_annotation_palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Group <span class="op">=</span> <span class="st">"Spectral"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>[Heatmap] Assuming 'row_annotation_agg["Group"] = dplyr::first' for the simple annotation</span>
<span class="r-plt img"><img src="Heatmap-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cluster"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">matrix_data</span>, rows_data <span class="op">=</span> <span class="va">rows_data</span>,</span></span>
<span class="r-in"><span>        rows_split_by <span class="op">=</span> <span class="st">"group"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="Heatmap-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cluster"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co"># add labels to the heatmap</span></span></span>
<span class="r-in"><span>    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">matrix_data</span>, rows_data <span class="op">=</span> <span class="va">rows_data</span>,</span></span>
<span class="r-in"><span>        rows_split_by <span class="op">=</span> <span class="st">"group"</span>, cell_type <span class="op">=</span> <span class="st">"label"</span>,</span></span>
<span class="r-in"><span>        label <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            <span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">number</a></span><span class="op">(</span><span class="va">x</span>, accuracy <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>, <span class="cn">NA</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="Heatmap-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use long form data</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">500</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span>, <span class="st">"Z"</span><span class="op">)</span>, <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    p1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    p2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cluster"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">data</span>, rows_by <span class="op">=</span> <span class="st">"r"</span>, columns_by <span class="op">=</span> <span class="st">"c"</span>, values_by <span class="op">=</span> <span class="st">"value"</span>,</span></span>
<span class="r-in"><span>        rows_split_by <span class="op">=</span> <span class="st">"p"</span>, columns_split_by <span class="op">=</span> <span class="st">"q"</span>, show_column_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="Heatmap-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cluster"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co"># split into multiple heatmaps</span></span></span>
<span class="r-in"><span>    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>        values_by <span class="op">=</span> <span class="st">"value"</span>, columns_by <span class="op">=</span> <span class="st">"c"</span>, rows_by <span class="op">=</span> <span class="st">"r"</span>, split_by <span class="op">=</span> <span class="st">"p"</span>,</span></span>
<span class="r-in"><span>        upper_cutoff <span class="op">=</span> <span class="fl">2</span>, lower_cutoff <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"right"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        design <span class="op">=</span> <span class="st">"AAAAAA#BBBBBBB"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="Heatmap-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cluster"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co"># cell_type = "bars" (default is "tile")</span></span></span>
<span class="r-in"><span>    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">data</span>, values_by <span class="op">=</span> <span class="st">"value"</span>, rows_by <span class="op">=</span> <span class="st">"r"</span>, columns_by <span class="op">=</span> <span class="st">"c"</span>,</span></span>
<span class="r-in"><span>        cell_type <span class="op">=</span> <span class="st">"bars"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="Heatmap-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cluster"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">data</span>, values_by <span class="op">=</span> <span class="st">"value"</span>, rows_by <span class="op">=</span> <span class="st">"r"</span>, columns_by <span class="op">=</span> <span class="st">"c"</span>,</span></span>
<span class="r-in"><span>        cell_type <span class="op">=</span> <span class="st">"dot"</span>, dot_size <span class="op">=</span> <span class="va">length</span>, dot_size_name <span class="op">=</span> <span class="st">"data points"</span>,</span></span>
<span class="r-in"><span>        add_bg <span class="op">=</span> <span class="cn">TRUE</span>, add_reticle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="Heatmap-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cluster"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">data</span>, values_by <span class="op">=</span> <span class="st">"value"</span>, rows_by <span class="op">=</span> <span class="st">"r"</span>, columns_by <span class="op">=</span> <span class="st">"c"</span>,</span></span>
<span class="r-in"><span>        cell_type <span class="op">=</span> <span class="st">"pie"</span>, pie_group_by <span class="op">=</span> <span class="st">"q"</span>, pie_size <span class="op">=</span> <span class="va">sqrt</span>,</span></span>
<span class="r-in"><span>        add_bg <span class="op">=</span> <span class="cn">TRUE</span>, add_reticle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="Heatmap-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cluster"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">data</span>, values_by <span class="op">=</span> <span class="st">"value"</span>, rows_by <span class="op">=</span> <span class="st">"r"</span>, columns_by <span class="op">=</span> <span class="st">"c"</span>,</span></span>
<span class="r-in"><span>        cell_type <span class="op">=</span> <span class="st">"violin"</span>, add_bg <span class="op">=</span> <span class="cn">TRUE</span>, add_reticle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="Heatmap-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cluster"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">data</span>, values_by <span class="op">=</span> <span class="st">"value"</span>, rows_by <span class="op">=</span> <span class="st">"r"</span>, columns_by <span class="op">=</span> <span class="st">"c"</span>,</span></span>
<span class="r-in"><span>        cell_type <span class="op">=</span> <span class="st">"boxplot"</span>, add_bg <span class="op">=</span> <span class="cn">TRUE</span>, add_reticle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="Heatmap-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cluster"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>        values_by <span class="op">=</span> <span class="st">"value"</span>, rows_by <span class="op">=</span> <span class="st">"r"</span>, columns_by <span class="op">=</span> <span class="st">"c"</span>,</span></span>
<span class="r-in"><span>        column_annotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>r1 <span class="op">=</span> <span class="st">"p"</span>, r2 <span class="op">=</span> <span class="st">"q"</span>, r3 <span class="op">=</span> <span class="st">"p1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        column_annotation_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>r1 <span class="op">=</span> <span class="st">"ring"</span>, r2 <span class="op">=</span> <span class="st">"bar"</span>, r3 <span class="op">=</span> <span class="st">"violin"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        column_annotation_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            r1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">"mm"</span><span class="op">)</span>, show_legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            r3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">18</span>, <span class="st">"mm"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>        row_annotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"q"</span>, <span class="st">"p2"</span>, <span class="st">"a"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        row_annotation_side <span class="op">=</span> <span class="st">"right"</span>,</span></span>
<span class="r-in"><span>        row_annotation_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>q <span class="op">=</span> <span class="st">"pie"</span>, p2 <span class="op">=</span> <span class="st">"density"</span>, a <span class="op">=</span> <span class="st">"simple"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        row_annotation_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">12</span>, <span class="st">"mm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        show_row_names <span class="op">=</span> <span class="cn">TRUE</span>, show_column_names <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>[Heatmap] Assuming 'row_annotation_agg["a"] = dplyr::first' for the simple annotation</span>
<span class="r-plt img"><img src="Heatmap-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cluster"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>        values_by <span class="op">=</span> <span class="st">"value"</span>, rows_by <span class="op">=</span> <span class="st">"r"</span>, columns_by <span class="op">=</span> <span class="st">"c"</span>,</span></span>
<span class="r-in"><span>        split_by <span class="op">=</span> <span class="st">"p"</span>, palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Reds"</span>, y <span class="op">=</span> <span class="st">"Blues"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="Heatmap-15.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cluster"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co"># implies in_form = "wide-rows"</span></span></span>
<span class="r-in"><span>    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">data</span>, rows_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p1"</span>, <span class="st">"p2"</span><span class="op">)</span>, columns_by <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="Heatmap-16.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cluster"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co"># implies wide-columns</span></span></span>
<span class="r-in"><span>    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">data</span>, rows_by <span class="op">=</span> <span class="st">"r"</span>, columns_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p1"</span>, <span class="st">"p2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="Heatmap-17.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Panwen Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

